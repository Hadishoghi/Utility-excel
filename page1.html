<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØµÙØ­Ù‡ 1 - ÙˆØ§Ø­Ø¯ Ù„Ø¬Ø³ØªÛŒÚ© Ø¢Ø°ÛŒÙ† Ø®ÙˆØ¯Ø±Ùˆ</title>
    <style>
        /* Ø³Ø¨Ú© Ø¯Ú©Ù…Ù‡ Ø±Ø§Ù‡Ù†Ù…Ø§ */
        .help-button {
            position: fixed;
            top: 10px;
            right: 10px;
            padding: 10px 20px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        /* Ø³Ø¨Ú© Ù¾Ù†Ø¬Ø±Ù‡ Ø±Ø§Ù‡Ù†Ù…Ø§ */
        .help-modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: white;
            padding: 20px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            z-index: 1000;
            width: 80%;
            max-width: 600px;
            font-family: Arial, sans-serif;
            line-height: 1.6;
        }

        /* Ø¯Ú©Ù…Ù‡ Ø¨Ø³ØªÙ† */
        .close-button {
            float: right;
            font-size: 20px;
            font-weight: bold;
            color: red;
            cursor: pointer;
        }

        /* Ø³Ø¨Ú© Ø¹Ù†ÙˆØ§Ù† */
        .help-modal h2 {
            margin-bottom: 20px;
            color: #333;
        }

        /* Ø³Ø¨Ú© Ù„ÛŒØ³Øª */
        .help-modal ul {
            list-style-type: disc;
            padding-left: 20px;
        }
    </style>
</head>
<body>

    <!-- Ø¹Ù†ÙˆØ§Ù† ØµÙØ­Ù‡ -->
    <h1>ØµÙØ­Ù‡ 1 - ÙˆØ§Ø­Ø¯ Ù„Ø¬Ø³ØªÛŒÚ© Ø¢Ø°ÛŒÙ† Ø®ÙˆØ¯Ø±Ùˆ</h1>
    <p>Ø¨Ù‡ ØµÙØ­Ù‡ Ù…Ø¯ÛŒØ±ÛŒØª ÙˆØ§Ø­Ø¯ Ù„Ø¬Ø³ØªÛŒÚ© Ø¢Ø°ÛŒÙ† Ø®ÙˆØ¯Ø±Ùˆ Ø®ÙˆØ´ Ø¢Ù…Ø¯ÛŒØ¯.</p>

    <!-- Ø¯Ú©Ù…Ù‡ Ø±Ø§Ù‡Ù†Ù…Ø§ -->
    <button class="help-button" onclick="openHelp()">Ø±Ø§Ù‡Ù†Ù…Ø§</button>

    <!-- Ù¾Ù†Ø¬Ø±Ù‡ Ø±Ø§Ù‡Ù†Ù…Ø§ -->
    <div id="helpModal" class="help-modal">
        <span class="close-button" onclick="closeHelp()">&times;</span>
        <h2>ğŸ“š Ø±Ø§Ù‡Ù†Ù…Ø§ÛŒ ØµÙØ­Ù‡ 1</h2>
        <ul>
            <li><strong>Ø§Ù†ØªØ®Ø§Ø¨ Ø³ØªÙˆÙ† Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„ØªØ±:</strong> Ø§Ø² Ù„ÛŒØ³Øª "Ø³ØªÙˆÙ† Ø±Ø§ Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„ØªØ± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯" Ø³ØªÙˆÙ† Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø®ÙˆØ¯ Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.</li>
            <li><strong>ÙÛŒÙ„ØªØ± ØªØ§Ø±ÛŒØ®:</strong> Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„ØªØ± Ú©Ø±Ø¯Ù† Ø¨Ø± Ø§Ø³Ø§Ø³ ØªØ§Ø±ÛŒØ®ØŒ Ø§Ø² Ú¯Ø²ÛŒÙ†Ù‡ "Ø³ØªÙˆÙ† ØªØ§Ø±ÛŒØ® Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯ Ùˆ Ø¨Ø§Ø²Ù‡ ØªØ§Ø±ÛŒØ® Ø±Ø§ ÙˆØ§Ø±Ø¯ Ú©Ù†ÛŒØ¯.</li>
            <li><strong>Ø§Ø¹Ù…Ø§Ù„ ÙÛŒÙ„ØªØ±Ù‡Ø§:</strong> Ø¨Ø¹Ø¯ Ø§Ø² ØªÙ†Ø¸ÛŒÙ… ÙÛŒÙ„ØªØ±Ù‡Ø§ØŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø§Ø¹Ù…Ø§Ù„ ÙÛŒÙ„ØªØ±Ù‡Ø§" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯ ØªØ§ ØªØºÛŒÛŒØ±Ø§Øª Ø§Ø¹Ù…Ø§Ù„ Ø´ÙˆÙ†Ø¯.</li>
            <li><strong>Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ ÙÛŒÙ„ØªØ±Ù‡Ø§:</strong> Ø¨Ø±Ø§ÛŒ Ø­Ø°Ù ØªÙ…Ø§Ù… ÙÛŒÙ„ØªØ±Ù‡Ø§ Ùˆ Ø¨Ø§Ø²Ú¯Ø´Øª Ø¨Ù‡ ÙˆØ¶Ø¹ÛŒØª Ø§ÙˆÙ„ÛŒÙ‡ØŒ Ø§Ø² Ø¯Ú©Ù…Ù‡ "Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ ÙÛŒÙ„ØªØ±Ù‡Ø§" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</li>
            <li><strong>Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„:</strong> Ø¨Ø±Ø§ÛŒ Ø¯Ø§Ù†Ù„ÙˆØ¯ ÙØ§ÛŒÙ„ Ø§Ú©Ø³Ù„ Ø§Ø² Ø¯Ø§Ø¯Ù‡â€ŒÙ‡Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¯Ø§Ø¯Ù‡ Ø´Ø¯Ù‡ØŒ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</li>
            <li><strong>Ù¾Ø±ÛŒÙ†Øª:</strong>
                <ul>
                    <li>Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ ØµØ­ÛŒØ­ØŒ Ø§Ø² Ø¯Ú©Ù…Ù‡ "Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ ØµØ­ÛŒØ­" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</li>
                    <li>Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ ØºÙ„Ø·ØŒ Ø§Ø² Ø¯Ú©Ù…Ù‡ "Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ ØºÙ„Ø·" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</li>
                    <li>Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ Ú†Ú© Ù†Ø´Ø¯Ù‡ØŒ Ø§Ø² Ø¯Ú©Ù…Ù‡ "Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ Ú†Ú© Ù†Ø´Ø¯Ù‡" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</li>
                    <li>Ø¨Ø±Ø§ÛŒ Ù¾Ø±ÛŒÙ†Øª ØªÙ…Ø§Ù… Ù…ÙˆØ§Ø±Ø¯ Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡ØŒ Ø§Ø² Ø¯Ú©Ù…Ù‡ "Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡" Ø§Ø³ØªÙØ§Ø¯Ù‡ Ú©Ù†ÛŒØ¯.</li>
                </ul>
            </li>
            <li><strong>Ø§Ù†ØªØ®Ø§Ø¨ Ù‡Ù…Ù‡:</strong> Ø¨Ø±Ø§ÛŒ Ø§Ù†ØªØ®Ø§Ø¨ Ù‡Ù…Ù‡ Ù…ÙˆØ§Ø±Ø¯ Ø¯Ø± ÛŒÚ© Ø³ØªÙˆÙ† Ø®Ø§ØµØŒ Ø§Ø¨ØªØ¯Ø§ Ø³ØªÙˆÙ† Ù…ÙˆØ±Ø¯ Ù†Ø¸Ø± Ø±Ø§ Ø§Ø² Ù„ÛŒØ³Øª "Ø³ØªÙˆÙ† Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯" Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ø±Ø¯Ù‡ Ùˆ Ø³Ù¾Ø³ Ø±ÙˆÛŒ Ø¯Ú©Ù…Ù‡ "Ø§Ù†ØªØ®Ø§Ø¨ Ù‡Ù…Ù‡" Ú©Ù„ÛŒÚ© Ú©Ù†ÛŒØ¯.</li>
            <li><strong>Ú†Ú© Ú©Ø±Ø¯Ù† Ù…ÙˆØ§Ø±Ø¯:</strong>
                <ul>
                    <li>Ø¨Ø±Ø§ÛŒ Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…ÙˆØ§Ø±Ø¯ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ØµØ­ÛŒØ­ØŒ ØªÛŒÚ© Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø³ØªÙˆÙ† "ØµØ­ÛŒØ­ (Ø³Ø¨Ø²)" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.</li>
                    <li>Ø¨Ø±Ø§ÛŒ Ø¹Ù„Ø§Ù…Øªâ€ŒÚ¯Ø°Ø§Ø±ÛŒ Ù…ÙˆØ§Ø±Ø¯ Ø¨Ù‡ Ø¹Ù†ÙˆØ§Ù† ØºÙ„Ø·ØŒ ØªÛŒÚ© Ù…Ø±Ø¨ÙˆØ· Ø¨Ù‡ Ø³ØªÙˆÙ† "ØºÙ„Ø· (Ù‚Ø±Ù…Ø²)" Ø±Ø§ Ø¨Ø²Ù†ÛŒØ¯.</li>
                </ul>
            </li>
        </ul>
        <p>ğŸ¥°ğŸ¥° ØªÙ‚Ø¯ÛŒÙ… Ø¨Ù‡ Ù‡Ù…Ú©Ø§Ø±Ø§Ù† Ù…Ø­ØªØ±Ù… Ø¬Ù‡Øª Ø³Ù‡ÙˆÙ„Øª Ø¯Ø± Ú†Ú© Ù†Ù…ÙˆØ¯Ù† Ø§Ø³Ù†Ø§Ø¯ ğŸ˜‹ğŸ¤©</p>
    </div>

    <script>
        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¨Ø§Ø² Ú©Ø±Ø¯Ù† Ù¾Ù†Ø¬Ø±Ù‡ Ø±Ø§Ù‡Ù†Ù…Ø§
        function openHelp() {
            document.getElementById("helpModal").style.display = "block";
        }

        // ØªØ§Ø¨Ø¹ Ø¨Ø±Ø§ÛŒ Ø¨Ø³ØªÙ† Ù¾Ù†Ø¬Ø±Ù‡ Ø±Ø§Ù‡Ù†Ù…Ø§
        function closeHelp() {
            document.getElementById("helpModal").style.display = "none";
        }
    </script>
<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AZIN KHODROO . SHOGHI</title>
    <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/jalaali-js/dist/jalaali.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            direction: rtl;
            text-align: right;
            margin: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        input[type="file"], input[type="text"], input[type="number"], input[type="date"], select {
            margin-bottom: 20px;
            padding: 10px;
            width: 100%;
            box-sizing: border-box;
        }
        .filters {
            margin-top: 20px;
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
        .filters div {
            flex: 1 1 calc(50% - 10px);
        }
        table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        table, th, td {
            border: 1px solid #ddd;
        }
        th, td {
            padding: 10px;
            text-align: left;
        }
        th {
            background-color: #f4f4f4;
        }
        .green-row {
            background-color: #28a745 !important;
            color: white;
        }
        .red-row {
            background-color: #dc3545 !important;
            color: white;
        }
        .checked-section {
            margin-top: 20px;
        }
        .checked-section h2 {
            color: green;
        }
        .reset-button, .export-button {
            margin-top: 10px;
            padding: 10px 20px;
            background-color: #f44336;
            color: white;
            border: none;
            cursor: pointer;
        }
        .export-button {
            background-color: #4CAF50;
            margin-left: 10px;
        }
        .reset-button:hover {
            background-color: #d32f2f;
        }
        .export-button:hover {
            background-color: #45a049;
        }
        .print-button {
            direction: rtl;
            text-align: right;
        }
        .print-buttons {
            display: none;
            flex-direction: column;
            gap: 10px;
            animation: shake 0.5s;
        }
        .print-buttons.show {
            display: flex;
        }

        @keyframes shake {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(0); }
        }

        @media print {
            .no-print {
                display: none;
            }
            #table-container {
                display: none;
            }
            .checked-section {
                display: block !important;
            }
            .checked-section h2 {
                display: none;
            }
            .green-row {
                background-color: #28a745 !important;
                color: white;
            }
            .red-row {
                background-color: #dc3545 !important;
                color: white;
            }
            #checked-items-container table {
                width: 100%;
                border-collapse: collapse;
                direction: rtl;
            }
            #checked-items-container th, #checked-items-container td {
                border: 1px solid #000;
                padding: 8px;
                text-align: center;
            }
        }

        #welcome-message {
            text-align: center;
            font-size: 20px;
            margin-top: 20px;
            color: green;
            padding: 10px;
            background-color: #f0f8ff;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
    </style>
</head>
<body>
    <div class="container">
        <div id="welcome-message">
            ğŸ¥°ğŸ¥°ØªÙ‚Ø¯ÛŒÙ… Ø¨Ù‡ Ù‡Ù…Ú©Ø§Ø±Ø§Ù† Ù…Ø­ØªØ±Ù… Ø¬Ù‡Øª Ø³Ù‡ÙˆÙ„Øª Ø¯Ø± Ú†Ú© Ù†Ù…ÙˆØ¯Ù† Ø§Ø³Ù†Ø§Ø¯ğŸ¤©ğŸ¤©
        </div>

        <h1 class="no-print">Ø·Ø±Ø§Ø­ÛŒ Ø§Ø®ØªØµØ§ØµÛŒ ÙˆØ§Ø­Ø¯ Ù„Ø¬Ø³ØªÛŒÚ© Ø¢Ø°ÛŒÙ† Ø®ÙˆØ¯Ø±Ùˆ</h1>
        <input type="file" id="upload" accept=".xlsx, .xls" class="no-print">
        <input type="text" id="search" class="no-print">

        <div class="filters no-print">
            <div>
                <select id="filter-column">
                    <option value="">Ø³ØªÙˆÙ† Ø±Ø§ Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„ØªØ± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                </select>
            </div>
            <div>
                <input type="text" id="filter-value">
            </div>
            <div>
                <input type="text" id="start-date">
            </div>
            <div>
                <input type="text" id="end-date">
            </div>
            <div>
                <select id="date-column">
                    <option value="">Ø³ØªÙˆÙ† ØªØ§Ø±ÛŒØ® Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
                </select>
            </div>
        </div>
        <button id="apply-filters" class="no-print">Ø§Ø¹Ù…Ø§Ù„ ÙÛŒÙ„ØªØ±Ù‡Ø§</button>
        <button id="reset-filters" class="reset-button no-print">Ø¨Ø§Ø²Ù†Ø´Ø§Ù†ÛŒ ÙÛŒÙ„ØªØ±Ù‡Ø§</button>
        <button id="export-excel" class="export-button no-print">Ø®Ø±ÙˆØ¬ÛŒ Ø§Ú©Ø³Ù„</button>
        <button id="print-button" class="export-button no-print print-button">Ù¾Ø±ÛŒÙ†Øª</button>
        <button id="select-all-button" class="export-button no-print print-button">Ø§Ù†ØªØ®Ø§Ø¨ Ù‡Ù…Ù‡</button>
        <select id="select-all-column" class="no-print">
            <option value="">Ø³ØªÙˆÙ† Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>
            <option value="green">ØµØ­ÛŒØ­ (Ø³Ø¨Ø²)</option>
            <option value="red">ØºÙ„Ø· (Ù‚Ø±Ù…Ø²)</option>
        </select>

        <div class="print-buttons no-print">
            <button id="print-checked-green" class="export-button print-button">Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ ØµØ­ÛŒØ­</button>
            <button id="print-checked-red" class="export-button print-button">Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ ØºÙ„Ø·</button>
            <button id="print-unchecked" class="export-button print-button">Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ Ú†Ú© Ù†Ø´Ø¯Ù‡</button>
            <button id="print-visible" class="export-button print-button">Ù¾Ø±ÛŒÙ†Øª Ù…ÙˆØ§Ø±Ø¯ Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡</button>
        </div>

        <div id="table-container"></div>
        <div class="checked-section">
            <h2 class="no-print">Ú†Ú© Ø´Ø¯Ù‡â€ŒÙ‡Ø§</h2>
            <div id="checked-items-container"></div>
        </div>
    </div>

    <script>

        const uploadInput = document.getElementById('upload');
        const searchInput = document.getElementById('search');
        const filterColumnSelect = document.getElementById('filter-column');
        const filterValueInput = document.getElementById('filter-value');
        const startDateInput = document.getElementById('start-date');
        const endDateInput = document.getElementById('end-date');
        const dateColumnSelect = document.getElementById('date-column');
        const applyFiltersButton = document.getElementById('apply-filters');
        const resetFiltersButton = document.getElementById('reset-filters');
        const exportExcelButton = document.getElementById('export-excel');
        const printButton = document.getElementById('print-button');
        const selectAllButton = document.getElementById('select-all-button');
        const selectAllColumnSelect = document.getElementById('select-all-column');
        const printCheckedGreenButton = document.getElementById('print-checked-green');
        const printCheckedRedButton = document.getElementById('print-checked-red');
        const printUncheckedButton = document.getElementById('print-unchecked');
        const printVisibleButton = document.getElementById('print-visible');
        const tableContainer = document.getElementById('table-container');
        const checkedItemsContainer = document.getElementById('checked-items-container');
        const printButtonsContainer = document.querySelector('.print-buttons');

        let tableData = [];
        let headers = [];
        let greenCheckedItems = new Set();
        let redCheckedItems = new Set();

        function renderTable(data) {
            const table = document.createElement('table');
            const thead = document.createElement('thead');
            const tbody = document.createElement('tbody');

            const headerRow = document.createElement('tr');
            const idHeader = document.createElement('th');
            idHeader.textContent = "ID";
            headerRow.appendChild(idHeader);

            const checkboxHeaderGreen = document.createElement('th');
            checkboxHeaderGreen.textContent = "ØµØ­ÛŒØ­ (Ø³Ø¨Ø²)";
            headerRow.appendChild(checkboxHeaderGreen);

            const checkboxHeaderRed = document.createElement('th');
            checkboxHeaderRed.textContent = "ØºÙ„Ø· (Ù‚Ø±Ù…Ø²)";
            headerRow.appendChild(checkboxHeaderRed);

            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });

            thead.appendChild(headerRow);

            data.forEach((row, rowIndex) => {
                const tr = document.createElement('tr');
                tr.dataset.id = row.id; // Add unique identifier

                const idCell = document.createElement('td');
                idCell.textContent = row.id;
                tr.appendChild(idCell);

                const checkboxCellGreen = document.createElement('td');
                const checkboxGreen = document.createElement('input');
                checkboxGreen.type = 'checkbox';
                checkboxGreen.checked = greenCheckedItems.has(row.id);
                checkboxGreen.classList.add('rowCheckboxGreen');
                checkboxGreen.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        greenCheckedItems.add(row.id);
                        redCheckedItems.delete(row.id);
                        tr.classList.add('green-row');
                        tr.classList.remove('red-row');
                    } else {
                        greenCheckedItems.delete(row.id);
                        tr.classList.remove('green-row');
                    }
                    updateCheckedItems();
                });
                checkboxCellGreen.appendChild(checkboxGreen);
                tr.appendChild(checkboxCellGreen);

                const checkboxCellRed = document.createElement('td');
                const checkboxRed = document.createElement('input');
                checkboxRed.type = 'checkbox';
                checkboxRed.checked = redCheckedItems.has(row.id);
                checkboxRed.classList.add('rowCheckboxRed');
                checkboxRed.addEventListener('change', (e) => {
                    if (e.target.checked) {
                        redCheckedItems.add(row.id);
                        greenCheckedItems.delete(row.id);
                        tr.classList.add('red-row');
                        tr.classList.remove('green-row');
                    } else {
                        redCheckedItems.delete(row.id);
                        tr.classList.remove('red-row');
                    }
                    updateCheckedItems();
                });
                checkboxCellRed.appendChild(checkboxRed);
                tr.appendChild(checkboxCellRed);

                headers.forEach(header => {
                    const td = document.createElement('td');
                    td.textContent = row[header];
                    tr.appendChild(td);
                });

                tbody.appendChild(tr);
            });

            table.appendChild(thead);
            table.appendChild(tbody);

            tableContainer.innerHTML = '';
            tableContainer.appendChild(table);

            updateCheckedItems();
        }

        function updateCheckedItems() {
            const checkedData = Array.from(greenCheckedItems).map(id => ({ ...tableData.find(row => row.id === id), id: "TRUE" }));
            const redCheckedData = Array.from(redCheckedItems).map(id => ({ ...tableData.find(row => row.id === id), id: "FALSE" }));
            const checkedTable = document.createElement('table');
            const thead = document.createElement('thead');
            const tbody = document.createElement('tbody');

            const headerRow = document.createElement('tr');
            const idHeader = document.createElement('th');
            idHeader.textContent = "ID";
            headerRow.appendChild(idHeader);

            headers.forEach(header => {
                const th = document.createElement('th');
                th.textContent = header;
                headerRow.appendChild(th);
            });
            thead.appendChild(headerRow);

            checkedData.forEach(row => {
                const tr = document.createElement('tr');
                const idCell = document.createElement('td');
                idCell.textContent = row.id;
                tr.appendChild(idCell);

                headers.forEach(header => {
                    const td = document.createElement('td');
                    td.textContent = row[header];
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });

            redCheckedData.forEach(row => {
                const tr = document.createElement('tr');
                const idCell = document.createElement('td');
                idCell.textContent = row.id;
                tr.appendChild(idCell);

                headers.forEach(header => {
                    const td = document.createElement('td');
                    td.textContent = row[header];
                    tr.appendChild(td);
                });
                tbody.appendChild(tr);
            });

            checkedTable.appendChild(thead);
            checkedTable.appendChild(tbody);

            checkedItemsContainer.innerHTML = '';
            checkedItemsContainer.appendChild(checkedTable);
        }

        uploadInput.addEventListener('change', (e) => {
            const file = e.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (event) => {
                    const data = new Uint8Array(event.target.result);
                    const workbook = XLSX.read(data, { type: 'array' });

                    const sheetName = workbook.SheetNames[0];
                    const sheet = workbook.Sheets[sheetName];
                    tableData = XLSX.utils.sheet_to_json(sheet);

                    // Add unique identifier to each row
                    tableData.forEach((row, index) => {
                        row.id = index;
                    });

                    headers = Object.keys(tableData[0]).filter(header => header !== 'id');

                    filterColumnSelect.innerHTML = '<option value="">Ø³ØªÙˆÙ† Ø±Ø§ Ø¨Ø±Ø§ÛŒ ÙÛŒÙ„ØªØ± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>';
                    headers.forEach(header => {
                        const option = document.createElement('option');
                        option.value = header;
                        option.textContent = header;
                        filterColumnSelect.appendChild(option);
                    });

                    dateColumnSelect.innerHTML = '<option value="">Ø³ØªÙˆÙ† ØªØ§Ø±ÛŒØ® Ø±Ø§ Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯</option>';
                    headers.forEach(header => {
                        const option = document.createElement('option');
                        option.value = header;
                        option.textContent = header;
                        dateColumnSelect.appendChild(option);
                    });

                    renderTable(tableData);
                };
                reader.readAsArrayBuffer(file);
            }
        });

        function jalaliToGregorian(jalaliDate) {
            const [year, month, day] = jalaliDate.split('/').map(Number);
            const gregorianDate = jalaali.toGregorian(year, month, day);
            return new Date(gregorianDate.gy, gregorianDate.gm - 1, gregorianDate.gd);
        }

        function applyFilters() {
            const query = searchInput.value.toLowerCase();
            const filterColumn = filterColumnSelect.value;
            const filterValue = filterValueInput.value.toLowerCase();
            const startDate = startDateInput.value;
            const endDate = endDateInput.value;
            const dateColumn = dateColumnSelect.value;

            const filteredData = tableData.filter((row, rowIndex) => {
                const matchesSearch = Object.values(row).some(value =>
                    value.toString().toLowerCase().includes(query)
                );

                let matchesColumnFilter = true;
                if (filterColumn && filterValue) {
                    const columnValue = row[filterColumn];
                    if (columnValue) {
                        matchesColumnFilter = columnValue.toString().toLowerCase().includes(filterValue);
                    } else {
                        matchesColumnFilter = false;
                    }
                }

                let matchesDate = true;
                if (dateColumn && row[dateColumn]) {
                    const rowDate = row[dateColumn];
                    if (typeof rowDate === 'string' && rowDate.match(/^\d{4}\/\d{2}\/\d{2}$/)) {
                        const rowDateObj = jalaliToGregorian(rowDate);
                        const startDateObj = startDate ? jalaliToGregorian(startDate) : null;
                        const endDateObj = endDate ? jalaliToGregorian(endDate) : null;

                        if (startDateObj && rowDateObj < startDateObj) matchesDate = false;
                        if (endDateObj && rowDateObj > endDateObj) matchesDate = false;
                    }
                }

                return matchesSearch && matchesColumnFilter && matchesDate;
            });

            renderTable(filteredData);
        }

        function resetFilters() {
            searchInput.value = '';
            filterColumnSelect.value = '';
            filterValueInput.value = '';
            startDateInput.value = '';
            endDateInput.value = '';
            dateColumnSelect.value = '';
            renderTable(tableData);
        }

        function exportToExcel() {
            const greenCheckedData = Array.from(greenCheckedItems).map(id => ({ ...tableData.find(row => row.id === id), id: "TRUE" }));
            const redCheckedData = Array.from(redCheckedItems).map(id => ({ ...tableData.find(row => row.id === id), id: "FALSE" }));
            const uncheckedData = tableData.filter(row => !greenCheckedItems.has(row.id) && !redCheckedItems.has(row.id)).map(row => ({ ...row, id: "" }));

            const wb = XLSX.utils.book_new();

            if (greenCheckedData.length > 0) {
                const wsGreen = XLSX.utils.json_to_sheet(greenCheckedData);
                XLSX.utils.book_append_sheet(wb, wsGreen, "ØµØ­ÛŒØ­ (Ø³Ø¨Ø²)");
            }

            if (redCheckedData.length > 0) {
                const wsRed = XLSX.utils.json_to_sheet(redCheckedData);
                XLSX.utils.book_append_sheet(wb, wsRed, "ØºÙ„Ø· (Ù‚Ø±Ù…Ø²)");
            }

            if (uncheckedData.length > 0) {
                const wsUnchecked = XLSX.utils.json_to_sheet(uncheckedData);
                XLSX.utils.book_append_sheet(wb, wsUnchecked, "Ú†Ú© Ù†Ø´Ø¯Ù‡");
            }

            XLSX.writeFile(wb, 'checked-items-export.xlsx');
        }

        function printCheckedItems(data, title) {
            if (data.length === 0) {
                alert("Ù‡ÛŒÚ† Ù…ÙˆØ±Ø¯ÛŒ ØªÛŒÚ© Ù†Ø®ÙˆØ±Ø¯Ù‡ Ø§Ø³Øª!");
                return;
            }

            const printWindow = window.open('', '', 'height=600,width=800');
            printWindow.document.write('<html><head><title>' + title + '</title></head><body>');
            printWindow.document.write('<h1>' + title + '</h1>');
            printWindow.document.write('<table border="1"><tr>');
            headers.forEach(header => {
                printWindow.document.write(`<th>${header}</th>`);
            });
            printWindow.document.write('</tr>');
            data.forEach(row => {
                printWindow.document.write('<tr>');
                headers.forEach(header => {
                    printWindow.document.write(`<td>${row[header]}</td>`);
                });
                printWindow.document.write('</tr>');
            });
            printWindow.document.write('</table></body></html>');
            printWindow.document.close();
            printWindow.print();
        }

        function printUncheckedItems() {
            const uncheckedData = tableData.filter(row => !greenCheckedItems.has(row.id) && !redCheckedItems.has(row.id));
            printCheckedItems(uncheckedData, "Ù…ÙˆØ§Ø±Ø¯ Ú†Ú© Ù†Ø´Ø¯Ù‡");
        }

        function printVisibleItems() {
            const visibleData = tableData.filter(row => {
                const rowElement = document.querySelector(`tr[data-id="${row.id}"]`);
                return rowElement && rowElement.offsetParent !== null;
            });
            printCheckedItems(visibleData, "Ù…ÙˆØ§Ø±Ø¯ Ù‚Ø§Ø¨Ù„ Ù…Ø´Ø§Ù‡Ø¯Ù‡");
        }

        function togglePrintButtons() {
            printButtonsContainer.classList.toggle('show');
        }

        function selectAll() {
            const selectedColumn = selectAllColumnSelect.value;
            const checkboxesGreen = document.querySelectorAll('.rowCheckboxGreen');
            const checkboxesRed = document.querySelectorAll('.rowCheckboxRed');
            const isChecked = !checkboxesGreen[0].checked;

            if (selectedColumn === 'green') {
                checkboxesGreen.forEach(checkbox => checkbox.checked = isChecked);
                checkboxesRed.forEach(checkbox => checkbox.checked = false);
                tableData.forEach(row => {
                    if (isChecked) {
                        greenCheckedItems.add(row.id);
                        redCheckedItems.delete(row.id);
                    } else {
                        greenCheckedItems.delete(row.id);
                    }
                });
            } else if (selectedColumn === 'red') {
                checkboxesRed.forEach(checkbox => checkbox.checked = isChecked);
                checkboxesGreen.forEach(checkbox => checkbox.checked = false);
                tableData.forEach(row => {
                    if (isChecked) {
                        redCheckedItems.add(row.id);
                        greenCheckedItems.delete(row.id);
                    } else {
                        redCheckedItems.delete(row.id);
                    }
                });
            }

            updateCheckedItems();
        }

        applyFiltersButton.addEventListener('click', applyFilters);
        resetFiltersButton.addEventListener('click', resetFilters);
        exportExcelButton.addEventListener('click', exportToExcel);
        printButton.addEventListener('click', togglePrintButtons);
        selectAllButton.addEventListener('click', selectAll);
        printCheckedGreenButton.addEventListener('click', () => printCheckedItems(Array.from(greenCheckedItems).map(id => tableData.find(row => row.id === id)), "Ù…ÙˆØ§Ø±Ø¯ ØµØ­ÛŒØ­"));
        printCheckedRedButton.addEventListener('click', () => printCheckedItems(Array.from(redCheckedItems).map(id => tableData.find(row => row.id === id)), "Ù…ÙˆØ§Ø±Ø¯ ØºÙ„Ø·"));
        printUncheckedButton.addEventListener('click', printUncheckedItems);
        printVisibleButton.addEventListener('click', printVisibleItems);
    </script>
</body>
</html>